# 前言

最好准备梯子，下载 SDK 什么的会方便些。

以下基础开发环境的搭建需要你自行查询资料搭建和配置，这里不再赘述。

# 配置基础开发环境

1.下载 Android Studio，配置 SDK、Build-tool、Command-tool、新建模拟器

2.安装 jdk 17

3.安装 Flutter 3.27.1 或相近版本，配置环境变量

# 本项目开发配置

下面按照 windows 演示，如果你是 macOS 思路是相同的，个别命令有所不同也影响不大，自己改下即可。

1.android/gradle.properties 中设置字段 org.gradle.java.home，指定 jdk 的位置，例如：

```txt
org.gradle.java.home=C:\\Program Files\\Java\\jdk-17
```

2.安卓 app 打包需要先生成签名，不然安装包会无法安装。不过，前期开发，可以先在模拟器上跑，不需要安装包的情况下，可以先不生成签名，但是还是强烈建议先自行生成签名，毕竟后面也要打包

3.假设你暂时不生成签名，只想先跑起来项目，你需要先找到 android/app/build.gradle，先将 buildTypes 下的 signingConfigs 相关行都注释

4.如果想先生成签名，请按照下面的步骤操作

- 打开终端，执行下面的命令切到桌面目录，方便待会找到生成的签名

```
cd .\Desktop\
```

- 然后执行下面的命令
```
keytool -genkeypair -alias my-key-alias -keyalg RSA -keysize 2048 -validity 3650 -keystore keystore.jks
```
执行时候会让我们输入密钥库命令，方便起见，直接输入 123456，然后让我们继续输入新口令，还是 123456。然后让我们输入名字姓氏、组织单位、组织名称、城市地域、省市区、国家地区，这些你都可以忽略，直接回车即可。紧接着，它会向你确认你以上填写的内容是否正确：

```
输入密钥库口令:

再次输入新口令:

您的名字与姓氏是什么?
  [Unknown]:
您的组织单位名称是什么?
  [Unknown]:
您的组织名称是什么?
  [Unknown]:
您所在的城市或区域名称是什么?
  [Unknown]:
您所在的省/市/自治区名称是什么?
  [Unknown]:
该单位的双字母国家/地区代码是什么?
  [Unknown]:
CN=Unknown, OU=Unknown, O=Unknown, L=Unknown, ST=Unknown, C=Unknown是否正确?
  [否]:
```

这时候你需要填写 y，表示确认，否则会继续让你输入上面的信息。

确认后，会让你输入密钥库密码和口令，直接 123456。

然后你会在桌面生成一个 keystore.jks 文件，这就是你的签名文件了。

然后在 android 目录下新建一个 key.properties 文件，新增如下配置：

```
storePassword=123456
keyPassword=123456
keyAlias=my-key-alias
storeFile=C:你自己的路径\\Desktop\\keystore.jks
```

这里有个关键点，如果你的 .jks 目录在其它地方，你复制过来的地址记得多加一个 \ 作为转义符 (macOS 自行判断)。

到这里，签名就准备好了，本地开发调试以及打包 apk 都不会受签名阻碍。

# 关于 vscode 开发

如果你使用 vscode 开发，那么你需要先下载 Flutter 插件

我们可以使用 flutter run 跑起来项目，不过，run 起来的项目没有自动热更新的能力，每次修改完想查看新效果都得点击一下终端，使得聚焦终端，然后执行快捷键 r 刷新。

类似的操作，我让豆包整理了一下：

| 快捷键 | 功能 |
| --- | --- |
| `r` | 热重载应用。它会在不丢失应用状态的情况下更新应用代码，能快速看到代码修改后的效果。  |
| `R` | 热重启应用。与热重载不同，热重启会重新初始化应用状态，适合修改了初始化代码或者需要重置应用状态时使用。 |
| `p` | 显示网格叠加层。这有助于你查看应用的布局结构，辅助进行界面布局的调试。 |
| `o` | 在不同的显示模式间切换，比如切换到无障碍模式、检查模式等，方便进行不同场景的测试。 |
| `h` | 显示快捷键帮助信息。当你记不清某个快捷键的功能时，按下 `h` 就可以查看完整的快捷键列表。 |
| `d` | 切换调试模式。可以在调试模式和非调试模式之间进行切换。 |
| `s` | 启用或禁用慢动画模式。在该模式下，动画的执行速度会变慢，便于你观察和调试动画效果。 |
| `w` | 打印 widget 树信息。可以帮助你了解当前应用界面的 widget 层级结构，排查布局问题。 |
| `t` | 打印渲染树信息。有助于你了解渲染对象的结构和状态。 |
| `i` | 打印服务信息。可以查看应用中各种服务的状态和信息。 |
| `q` | 退出应用。当你完成调试后，按下 `q` 可以终止应用的运行。 |

但是我平时用得最多的还是 debug 模式，你可以直接在 vscode 左侧点击运行和调试，vscode 会跑起来项目并进入 debug 模式，debug 模式是自动热更新的，保存完代码就会自动刷新应用，对于我们打断点查看数据也是更为方便。

# 真机调试

1.手机打开开发者模式和 usb 调试

- 点击进入设置 => 关于手机 => 版本信息 => 软件版本号 => 连续点击多下进入开发者模式
- 设置里搜索 “开发者选项”，找到 “usb调试”，打开

2.使用 usb 线连接电脑和手机

3.在 vscode 右下角选择设备，弹出可用设备弹窗，例如我的会显示：

```
Chrome
Edge
Windows
Start Medium Phone API 43
V2331A
```

V2331A 就是我的手机，点击选择该设备，执行 flutter run 或者打开 debug 模式，就会将 app 运行到真机。